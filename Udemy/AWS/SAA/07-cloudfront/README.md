# Cloudfront

## üåç Clases de precio de CloudFront (Price Classes)

| Clase de precio     | Regiones incluidas                                                                                                             |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| **Price Class All** | Todas las ubicaciones de borde (edge locations) disponibles mundialmente ([Amazon Web Services, Inc.][1])                      |
| **Price Class 200** | Incluye Price Class 100 **m√°s**: Sud√°frica, Kenia, Medio Oriente, Jap√≥n, Singapur, Corea del Sur, Taiw√°n, Hong‚ÄØKong, Filipinas |
| **Price Class 100** | Solo EEUU, Canad√°, Europa e Israel                                                                                             |

---

## üí∏ Precios promedio estimados por regi√≥n (Edge Data Transfer + HTTPS requests)

Basado en las tarifas de CloudFront actualizadas:

| Regi√≥n                        | Transferencia ‚àº\$/GB | HTTPS Requests ‚àº\$/10‚ÄØk                                                    |
| ----------------------------- | -------------------- | -------------------------------------------------------------------------- |
| **EE.‚ÄØUU., Canad√°**           | \$0.085              | \$0.010                                                                    |
| **Europa, Israel**            | \$0.085              | \$0.012                                                                    |
| **Asia Pac√≠fico (ej. Jap√≥n)** | \$0.114              | \$0.012                                                                    |
| **Sudam√©rica**                | \$0.110              | \$0.022                                                                    |
| **Oriente Medio/√Åfrica**      | \$0.110              | \$0.009‚Äì0.022 seg√∫n pa√≠s ([Amazon Web Services, Inc.][1], [Simple AWS][2]) |

---

## üõ†Ô∏è Estrategias de optimizaci√≥n

- Selecciona la **Price Class** seg√∫n la ubicaci√≥n principal de tus usuarios:

  - Si solo atiendes a **Am√©rica del Norte y Europa**, usa **Class‚ÄØ100** para reducir costos tan bajos como \$0.085/GB.
  - Si tambi√©n necesitas llegar a **Asia o Sud√°frica**, elige **Class‚ÄØ200**.
  - Para **audiencia global completa**, elige **Class All** para m√°xima cobertura a mayor costo.

- Reducir **n√∫mero de edge locations** puede disminuir costos, pero puede aumentar la latencia para usuarios fuera de las regiones activas.

---

### üß† Resumen

- **Price Class 100**: EEUU, Canad√°, Europa, Israel.
- **Price Class 200**: ‚óè Class‚ÄØ100 + Jap√≥n, Singapur, Corea, Hong‚ÄØKong, Taiw√°n, Medio‚ÄØOriente, √Åfrica.
- **Price Class All**: todas las edge locations.
- Los precios por GB suben desde \$0.085 (regiones baratas) hasta \$0.114‚Äì\$0.110 en regiones como Jap√≥n o Sud√°frica.
- Las requests HTTPS var√≠an entre \$0.01 y \$0.022 por 10‚ÄØ000.
- Elegir correctamente tu Price Class permite un buen balance entre **coste** y **rendimiento global**.

---

[1]: https://aws.amazon.com/cloudfront/pricing/ "Amazon CloudFront CDN - Plans & Pricing - Try For Free - AWS"
[2]: https://newsletter.simpleaws.dev/p/amazon-cloudfront-optimizing-content-delivery "Amazon CloudFront: Optimizing Content Delivery - Simple AWS"

## üîÑ **Invalidaciones de cach√© en CloudFront**

---

### üß† ¬øPor qu√© hacer una invalidaci√≥n?

CloudFront **almacena en cach√© el contenido del origen (backend)** por un tiempo definido por el **TTL (Time To Live)**.
Si el contenido del origen cambia, CloudFront **no lo actualizar√° inmediatamente**.

‚û°Ô∏è El contenido seguir√° sirvi√©ndose **desde la cach√©** hasta que expire el TTL.

---

### üí• ¬øQu√© es una invalidaci√≥n?

Una **invalidation** es un proceso para **eliminar objetos espec√≠ficos o todos** de la cach√© de CloudFront **antes** de que expire su TTL.

Una vez invalidado:

- CloudFront eliminar√° ese archivo de la cach√©.
- En la pr√≥xima solicitud, ir√° al origen para obtener el nuevo contenido.

---

### üõ†Ô∏è Opciones de invalidaci√≥n

| Tipo de invalidaci√≥n                       | Descripci√≥n                                            |
| ------------------------------------------ | ------------------------------------------------------ |
| üîÑ **Total (`/*`)**                        | Invalida todos los objetos almacenados en cach√©        |
| üìÇ **Parcial (`/css/*`, `/img/logo.png`)** | Invalida solo una ruta espec√≠fica o patr√≥n de archivos |

---

### üìò Ejemplo pr√°ctico

Sup√≥n que actualizas tu archivo de estilos CSS en el origen, ubicado en `/styles/app.css`.

#### ‚úÖ Opci√≥n 1: Invalidez solo el archivo

```bash
aws cloudfront create-invalidation \
  --distribution-id EXXXXXX123 \
  --paths "/styles/app.css"
```

#### ‚úÖ Opci√≥n 2: Invalidez todo (‚ö†Ô∏è m√°s costosa)

```bash
aws cloudfront create-invalidation \
  --distribution-id EXXXXXX123 \
  --paths "/*"
```

---

### üí≤ Costos

| Detalle                                  | Costo                                    |
| ---------------------------------------- | ---------------------------------------- |
| Primeras **1,000 invalidaciones** al mes | ‚úÖ **Gratis**                            |
| A partir de la **1001**                  | **\$0.005 por cada solicitud adicional** |

---

### ‚úÖ Buenas pr√°cticas

| Pr√°ctica                                | Descripci√≥n                                                                                   |
| --------------------------------------- | --------------------------------------------------------------------------------------------- |
| üè∑Ô∏è Versionar archivos                   | Ej: `/app.v2.css` en vez de `/app.css` ‚Üí evita tener que invalidar                            |
| ‚è±Ô∏è Usar TTL bajo para archivos cr√≠ticos | Solo si cambian frecuentemente                                                                |
| üéØ Invalidar solo lo necesario          | Invalida rutas espec√≠ficas en vez de usar `/*` siempre                                        |
| ‚öôÔ∏è Automatizar                          | Puedes hacer invalidaciones autom√°ticas desde CI/CD (ej: GitHub Actions) al desplegar cambios |

---

## üìå Resumen

- Las invalidaciones te permiten **refrescar la cach√©** de CloudFront antes de que expire.
- Se pueden hacer por ruta o de forma total.
- Las primeras 1,000 son gratis al mes.
- Ideal para cambios cr√≠ticos como archivos JS/CSS, im√°genes, landing pages, etc.
- Evita abusar de `/*` y mejor usa nombres versionados en archivos si puedes.

## üåç **AWS Global Accelerator (GA)** ‚Äì Visi√≥n general

---

### üöÄ ¬øQu√© es?

Es un **servicio de red global** que mejora el rendimiento y disponibilidad de aplicaciones de usuario final accediendo a servicios AWS (como ALB, NLB, EC2, etc.) usando la red **privada global de AWS**.

---

## üß† **Conceptos clave**

| Concepto                     | Detalle                                                                                                 |
| ---------------------------- | ------------------------------------------------------------------------------------------------------- |
| **Anycast IPs**              | Crea **2 direcciones IP est√°ticas** (anycast) que los usuarios finales usar√°n para conectarse           |
| **Rutas √≥ptimas**            | El tr√°fico se enruta a trav√©s de la red troncal de AWS para alcanzar el destino m√°s cercano y saludable |
| **Enrutamiento inteligente** | Detecta problemas de red y enruta al endpoint m√°s disponible o m√°s cercano                              |
| **Alta disponibilidad**      | Proporciona **failover autom√°tico y r√°pido** entre regiones o endpoints                                 |
| **Protocolo soportado**      | Funciona con **TCP o UDP**, a diferencia de CloudFront que es solo HTTP/HTTPS                           |
| **Integraci√≥n**              | Compatible con ALB, NLB, EC2 (con Elastic IPs), IP est√°ticas, multi-region, etc.                        |

---

### üìç Unicast vs Anycast

| Tipo de IP  | Significado                                                | Caso                                         |
| ----------- | ---------------------------------------------------------- | -------------------------------------------- |
| **Unicast** | Una IP ‚Üî un servidor                                       | Tradicional (1:1)                            |
| **Anycast** | Una IP ‚Üî m√∫ltiples servidores geogr√°ficamente distribuidos | Se enruta al servidor **m√°s cercano** (1\:N) |

---

### üîê Seguridad

- Solo necesitas **permitir 2 direcciones IP** en tu firewall (las IPs anycast asignadas).
- Protecci√≥n integrada con **AWS Shield** (b√°sico y opcionalmente avanzado).
- **No es accesible p√∫blicamente como CloudFront**, requiere routing controlado.

---

## ‚öôÔ∏è **Componentes de AWS Global Accelerator**

| Componente          | Descripci√≥n                                        |
| ------------------- | -------------------------------------------------- |
| **Accelerator**     | El recurso principal que contiene las 2 IP anycast |
| **Listeners**       | Controlan los puertos y protocolos (ej: TCP:443)   |
| **Endpoint groups** | Asociados a regiones espec√≠ficas                   |
| **Endpoints**       | Targets concretos: ALB, NLB, EC2, EIP              |

---

## üìä Diferencia clave: Global Accelerator vs CloudFront

| Caracter√≠stica               | Global Accelerator                                                                        | CloudFront                                      |
| ---------------------------- | ----------------------------------------------------------------------------------------- | ----------------------------------------------- |
| **Protocolo**                | TCP/UDP                                                                                   | HTTP/HTTPS                                      |
| **Contenido**                | Din√°mico y en tiempo real                                                                 | Est√°tico y din√°mico en cach√©                    |
| **Soporte no-HTTP**          | ‚úÖ S√≠ (ej: juegos, VoIP, MQTT)                                                            | ‚ùå No                                           |
| **IP est√°ticas**             | ‚úÖ S√≠ (Anycast)                                                                           | ‚ùå No (DNS)                                     |
| **Failover regional r√°pido** | ‚úÖ Muy r√°pido (subsegundos)                                                               | ‚ö†Ô∏è Lento (basado en TTL DNS)                    |
| **Ubicaci√≥n de borde**       | Proxy de paquetes en el borde + backhaul a AWS                                            | Cache en edge location                          |
| **Rendimiento**              | Ideal para tr√°fico sensible a latencia (e.g. multiplayer, financieros, streaming en vivo) | Ideal para sitios web, archivos, APIs cachables |

---

### üß™ Ejemplo de uso real

> Imagina un juego online en tiempo real con servidores en Virginia y Tokio.
> Usuarios de Latinoam√©rica y Europa se conectan a una **IP est√°tica**.
> Global Accelerator redirige autom√°ticamente al servidor m√°s cercano y con menor latencia usando la red interna de AWS, con recuperaci√≥n autom√°tica si uno de los endpoints falla.

---

## ‚úÖ Ventajas

| Ventaja                            | Explicaci√≥n                                               |
| ---------------------------------- | --------------------------------------------------------- |
| ‚ö° Baj√≠sima latencia global        | Al usar la red troncal optimizada de AWS                  |
| üõ†Ô∏è Conmutaci√≥n por error r√°pida    | Cambio autom√°tico de regi√≥n o endpoint sin cambiar DNS    |
| üåê IPs est√°ticas globales          | √ötil para clientes firewall-restringidos o listas blancas |
| üîß No requiere migrar arquitectura | Se puede agregar sobre infra existente                    |
| üß™ Soporta UDP y TCP               | Ideal para m√°s tipos de aplicaci√≥n que CloudFront         |

---

## üß† Casos de uso comunes

- Juegos multijugador (UDP)
- Voz sobre IP (VoIP)
- Finanzas en tiempo real (baja latencia)
- APIs con IP fija (para firewalling)
- Alta disponibilidad multi-regi√≥n con failover r√°pido
- Aplicaciones m√≥viles con distribuci√≥n global
